<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetris Corrigido</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .game-container {
            width: 95vw; max-width: 800px; background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px); border-radius: 20px;
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255,255,255,0.2);
            display: flex; padding: 20px; gap: 20px;
        }
        canvas { background: rgba(0, 0, 0, 0.7); border-radius: 10px; }
        .info-panel {
            display: flex; flex-direction: column; gap: 20px; color: white; width: 200px;
        }
        .score-container, .level-container, .next-piece-container {
            background: rgba(0,0,0,0.5); padding: 10px; border-radius: 10px;
            text-align: center; border: 1px solid rgba(255,255,255,0.1);
        }
        .score-value, .level-value {
            font-size: 2rem; font-weight: bold; color: #ffcc00;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <canvas id="tetris" width="200" height="400"></canvas>
        <div class="info-panel">
            <div class="score-container">
                <div class="score-title">Pontuação</div>
                <div class="score-value" id="score">0</div>
            </div>
            <div class="level-container">
                <div class="level-title">Nível</div>
                <div class="level-value" id="level">1</div>
            </div>
            <div class="next-piece-container">
                <div class="next-piece-title">Próxima</div>
                <canvas id="nextPiece" width="80" height="80"></canvas>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById("tetris");
        const ctx = canvas.getContext("2d");
        const nextCanvas = document.getElementById("nextPiece");
        const nextCtx = nextCanvas.getContext("2d");
        const scoreElement = document.getElementById("score");
        const levelElement = document.getElementById("level");

        const scale = 20;
        const rows = canvas.height / scale;
        const columns = canvas.width / scale;

        const pieces = [
            { shape: [[1, 1, 1, 1]], color: '#FF4136' },
            { shape: [[1, 1, 1], [0, 1, 0]], color: '#2ECC40' },
            { shape: [[1, 1], [1, 1]], color: '#B10DC9' },
            { shape: [[0, 1, 1], [1, 1, 0]], color: '#FF851B' },
        ];

        let board = Array.from({ length: rows }, () => Array(columns).fill(0));
        let currentPiece, nextPiece, score = 0, level = 1;

        function spawnPiece() {
            if (!nextPiece) {
                nextPiece = randomPiece();
            }
            currentPiece = {
                ...nextPiece,
                position: { x: Math.floor(columns / 2) - 1, y: 0 }
            };
            nextPiece = randomPiece();
            drawNextPiece();
        }

        function randomPiece() {
            const p = pieces[Math.floor(Math.random() * pieces.length)];
            return { shape: p.shape, color: p.color };
        }

        function drawBoard() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let y = 0; y < rows; y++) {
                for (let x = 0; x < columns; x++) {
                    if (board[y][x]) {
                        ctx.fillStyle = board[y][x];
                        ctx.fillRect(x * scale, y * scale, scale, scale);
                    }
                }
            }
        }

        function drawPiece() {
            const { shape, color, position } = currentPiece;
            shape.forEach((row, y) => {
                row.forEach((value, x) => {
                    if (value) {
                        ctx.fillStyle = color;
                        ctx.fillRect((position.x + x) * scale, (position.y + y) * scale, scale, scale);
                    }
                });
            });
        }

        function drawNextPiece() {
            nextCtx.clearRect(0, 0, nextCanvas.width, nextCanvas.height);
            const blockSize = 20;
            nextPiece.shape.forEach((row, y) => {
                row.forEach((value, x) => {
                    if (value) {
                        nextCtx.fillStyle = nextPiece.color;
                        nextCtx.fillRect(x * blockSize, y * blockSize, blockSize - 2, blockSize - 2);
                    }
                });
            });
        }

        function gameLoop() {
            drawBoard();
            drawPiece();
            requestAnimationFrame(gameLoop);
        }

        function updateScore(n) {
            score += n;
            scoreElement.textContent = score;
        }

        function updateLevel(n) {
            level = n;
            levelElement.textContent = level;
        }

        spawnPiece();
        updateScore(0);
        updateLevel(1);
        gameLoop();
    </script>
</body>
</html>